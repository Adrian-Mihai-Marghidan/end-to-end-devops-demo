# infra/docker-compose.staging.yml
services:
  web:
    image: ghcr.io/${GITHUB_REPOSITORY,,}/web:${TAG_STG:-staging-latest}
    ports:
      - "8083:80"     # web (staging)
    restart: unless-stopped

  backend:
    image: ghcr.io/${GITHUB_REPOSITORY,,}/backend:${TAG_STG:-staging-latest}
    # în staging nu mai e nevoie de build local; folosești imaginea din registry
    ports:
      - "3002:3000"   # opțional, doar dacă vrei să accesezi direct backend-ul
    restart: unless-stopped

  prometheus:
    volumes:
      - ./prometheus/prometheus.dev.yml:/etc/prometheus/prometheus.yml:ro
    ports:
      - "9091:9090"   # Prometheus (staging)

  grafana:
    ports:
      - "3002:3000"   # Grafana (staging)
    environment:
      - GF_SECURITY_ADMIN_USER=admin
      - GF_SECURITY_ADMIN_PASSWORD=admin
